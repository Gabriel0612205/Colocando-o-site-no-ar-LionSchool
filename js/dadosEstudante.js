"use strict";

//Função criada para retornar o aluno selecionado, trazendo a foto e o nome do aluno
const alunoSelecionadoMatricula=async function(a){const b=await fetch(`http://localhost:8080/v1/lion-school/alunos-matricula?matricula=${a}`),c=await b.json();return{image:c.aluno[0].foto,name:c.aluno[0].nome}};let registroEstudante=localStorage.getItem("numeroRegistro");const estudanteEDisciplinas=async function(a){const b=await fetch(`http://localhost:8080/v1/lion-school/alunos-disciplinas?matricula=${a}`),c=await b.json();return{nome:c.disciplinas.map(a=>a.nome),average:c.disciplinas.map(a=>a.media)}},filtragemDadosCurso=async function(){const a=await estudanteEDisciplinas(registroEstudante),b=await alunoSelecionadoMatricula(registroEstudante),c=document.querySelector(".container_aluno_selecionado"),d=document.createElement("img");d.classList.add("imagem_aluno"),d.setAttribute("src",b.image);const e=document.createElement("span");e.classList.add("nome_aluno"),e.textContent=b.name,c.append(d,e);let f=[];for(let b,c=0;c<a.nome.length;c++){b=a.nome[c],b=b.split(" ");let d="";b.forEach(a=>{let b=[];b.push(a),d+=b[0][0]}),f.push(d.toUpperCase())}const g=document.querySelector(".container_grafico_desempenho_aluno");let h,j,k,l,m;for(let b=0;b<a.average.length;b++)h=document.createElement("div"),h.classList.add("grade"),l=document.createElement("span"),l.classList.add("grade_titulo"),l.textContent=a.average[b],j=document.createElement("div"),j.classList.add("container_grade"),k=document.createElement("div"),k.classList.add("barras_grade"),j.append(k),m=document.createElement("div"),m.classList.add("atributos_nome_grade"),m.textContent=f[b],h.append(l,j,m),g.append(h);const n=document.querySelectorAll(".grade_titulo"),o=document.querySelectorAll(".barras_grade"),p=function(){n.forEach((a,b)=>{if(49>=a.textContent){let c=a.textContent;a.style.color="#ff0000",o[b].style.backgroundColor="#ff0000",o[b].style.boxShadow="0px 0px 24px #ff0000",o[b].style.height=`${c}%`,o[b].style.width="100%"}else if(50<=a.textContent&&69>=a.textContent){let c=a.textContent;a.style.color="#ffff00",o[b].style.backgroundColor="#ffff00",o[b].style.boxShadow="0px 0px 24px #ffff00",o[b].style.height=`${c}%`,o[b].style.width="100%"}else if(70<=a.textContent){let c=a.textContent;a.style.color="#00ffff",o[b].style.backgroundColor="#00ffff",o[b].style.boxShadow="0px 0px 24px #00ffff",o[b].style.height=`${c}%`,o[b].style.width="100%"}})},q=function(){n.forEach((a,b)=>{if(49>=a.textContent){let c=a.textContent;a.style.color="#ff0000",o[b].style.backgroundColor="#ff0000",o[b].style.boxShadow="0px 0px 24px #ff0000",o[b].style.width=`${c}%`,o[b].style.height="100%"}else if(50<=a.textContent&&69>=a.textContent){let c=a.textContent;a.style.color="#ffff00",o[b].style.backgroundColor="#ffff00",o[b].style.boxShadow="0px 0px 24px #ffff00",o[b].style.width=`${c}%`,o[b].style.height="100%"}else if(70<=a.textContent){let c=a.textContent;a.style.color="#00ffff",o[b].style.backgroundColor="#00ffff",o[b].style.boxShadow="0px 0px 24px #00ffff",o[b].style.width=`${c}%`,o[b].style.height="100%"}})};let r=window.matchMedia("(max-width: 600px)");window.addEventListener("resize",function(){r.matches?q():p()}),r.matches?q():p()};filtragemDadosCurso();
